<div class="wrap">
    <div class="dropzone" [class.dragging]="dragging()" (dragover)="onDragOver($event)"
        (dragleave)="onDragLeave($event)" (drop)="onDrop($event)" (click)="fileInput.click()" tabindex="0"
        (keyup.enter)="fileInput.click()" aria-label="Upload image dropzone">


        <div class="inner">
            <div class="icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" width="56" height="56">
                    <path d="M21 19V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14" fill="none" stroke="currentColor"
                        stroke-width="1.5" />
                    <rect x="3" y="5" width="18" height="14" rx="2" ry="2" fill="none" stroke="currentColor"
                        stroke-width="1.5" />
                    <circle cx="9" cy="9" r="2" fill="currentColor" />
                    <path d="M3 17l5-5 4 4 3-3 5 5" fill="none" stroke="currentColor" stroke-width="1.5"
                        stroke-linecap="round" />
                </svg>
            </div>

            <p class="title">
                Drop your image here, or
                <button class="browse" type="button" (click)="$event.stopPropagation(); fileInput.click()">
                    browse
                </button>
            </p>

            <p class="hint">Supports: JPG, PNG</p>

            <input #fileInput type="file" accept="image/*" (change)="onFilePicked($event)" hidden />
        </div>
    </div>

    <div class="progress-card" *ngIf="state() !== 'idle'">
        <div class="row">
            <div class="status">
                <strong *ngIf="state()==='uploading'">Uploading…</strong>
                <strong *ngIf="state()==='done'">Uploaded ✔</strong>
                <strong *ngIf="state()==='error'">Failed ✖</strong>
                <span class="name" *ngIf="fileName">{{ fileName }}</span>
            </div>
            <div class="actions">
                <button class="ghost" *ngIf="state()==='uploading'" (click)="cancel()">✕</button>
                <button class="ghost" *ngIf="state()==='error'" (click)="reset()">↻</button>
            </div>
        </div>
        <div class="bar" *ngIf="state()!=='done'">
            <div class="fill" [style.width.%]="progress()"></div>
        </div>
    </div>

    <p class="error" *ngIf="errorMsg">{{ errorMsg }}</p>
</div>